<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>三劍客量化科技(籌備中)</title>
  <meta name="robots" content="noindex,nofollow" />
  <!-- CSP + 反嵌入 -->
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'self';
             script-src 'self' https://unpkg.com https://byhbmmnacezzgkwfkozs.supabase.co 'unsafe-inline';
             style-src 'self' 'unsafe-inline';
             img-src 'self' data: https://byhbmmnacezzgkwfkozs.supabase.co;
             connect-src 'self' https://byhbmmnacezzgkwfkozs.supabase.co https://unpkg.com;
             frame-ancestors 'none';
             base-uri 'none';
             form-action 'self'">
  <style>
    :root { --card-r:12px; }
    body{
      font-family: Arial,"微軟正黑體",sans-serif;
      margin:20px;
      background:#f8f9fa;
      color:#333;
      -webkit-font-smoothing:antialiased;
    }
    hr{ border:none; border-top:1px solid #ddd; margin:20px auto; max-width:1100px }

    .section-title-red{
      max-width:1100px; margin:10px auto 12px;
      font-size:20px; font-weight:800; color:#d32f2f; letter-spacing:.5px;
    }
    .section-title-blue{
      max-width:1100px; margin:10px auto 12px;
      font-size:20px; font-weight:800; color:#0d6efd; letter-spacing:.5px;
    }
    .section-title-black{
      max-width:1100px; margin:10px auto 12px;
      font-size:20px; font-weight:800; color:#111; letter-spacing:.5px;
    }

    .strategy-grid{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:20px;
      max-width:1100px;
      margin:0 auto 28px;
    }
    .strategy-col{ display:flex; flex-direction:column; gap:12px }
    .subcat{
      font-weight:700; font-size:16px;
      color:#c62828; margin:0 0 4px 0; text-align:center;
    }

    .nav{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:20px;
      max-width:1100px;
      margin:0 auto 28px;
    }

    a.card{
      display:block;
      background:#fff;
      padding:18px 16px;
      border-radius:12px;
      box-shadow:0 2px 8px rgba(0,0,0,.08);
      text-decoration:none;
      color:inherit;
      transition:transform .15s, box-shadow .15s;
      border:1px solid #e5e7eb;
    }
    a.card:hover{
      transform:translateY(-4px);
      box-shadow:0 10px 22px rgba(0,0,0,.12);
    }
    .card-title{
      font-weight:700;
      font-size:18px;
      margin:0 0 8px 0;
      text-align:center;
    }
    .card-title.big{ font-size:22px; }
    .card-title.red{ color:#d32f2f }
    .card-title.blue{ color:#0d6efd }
    .card-title.gray{ color:#6c757d }
    .card-title.black{ color:#111 }

    .card-desc{ margin:0; color:#666; font-size:14px; line-height:1.5; text-align:left }

    .lines{ margin-top:2px }
    .line{
      display:grid;
      grid-template-columns:1.1fr 3.1fr;
      align-items:center;
      margin:4px 0;
      font-size:12px;
      column-gap:6px;
    }
    .label{
      text-align:center;
      color:#111;
      white-space:nowrap;
    }

    /* 右側：兩行，上＝當週，下＝累計；數字都靠右，上面多退一點 */
    .valblock{
      display:flex;
      flex-direction:column;
      row-gap:2px;
    }
    .sub-row{
      display:flex;
      align-items:center;
      column-gap:4px;
      font-size:10px;
      white-space:nowrap;
      justify-content:space-between;
    }
    .sub-row.cur{ padding-right:2.5em; }  /* 當週數字往左退一點（約全形 3~4 字寬） */
    .sub-row.cum{ padding-right:0; }      /* 累計數字貼最右 */

    .sub-range{
      font-size:10px;
      color:#999;
    }
    .sub-val{
      font-size:12px;
      font-weight:700;
    }
    .sub-val.pos{ color:#d32f2f }
    .sub-val.neg{ color:#10b981 }
    .sub-val.neu{ color:#666 }

    .period{
      margin-top:6px;
      color:#666;
      font-size:12px;
      text-align:center;
    }

    .gate{
      max-width:960px;
      margin:20px auto;
      background:#fff;
      border:1px solid #e5e7eb;
      border-radius:12px;
      box-shadow:0 2px 10px rgba(0,0,0,.05);
      padding:16px;
    }
    .row{ display:flex; gap:12px; align-items:center; flex-wrap:wrap }
    .btn{
      background:#0d6efd;
      color:#fff;
      border:0;
      border-radius:10px;
      padding:10px 14px;
      cursor:pointer;
    }
    .btn.gray{ background:#6c757d }
    input[type="password"]{
      width:100%; padding:10px;
      border:1px solid #e5e7eb;
      border-radius:8px;
    }
    .error{ color:#c62828; font-size:12px; margin-top:6px; display:none }
    .hidden{ display:none }

    html,body{
      -webkit-user-select:none;
      -moz-user-select:none;
      user-select:none;
      -webkit-touch-callout:none;
    }
    a,button,input{
      -webkit-user-select:auto;
      user-select:auto;
    }
    #shield{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background:rgba(3,7,18,.96);
      color:#fff;
      z-index:2147483647;
      text-align:center;
      padding:24px;
    }
  </style>
</head>
<body translate="no">
  <div id="shield"><div><h3>頁面受保護</h3>偵測到嘗試檢視原始碼或開發者工具，請關閉後重新整理。</div></div>

  <!-- (A) 密碼門檻 -->
  <div id="gate" class="gate">
    <div class="row" style="margin-top:12px;max-width:420px">
      <input id="pwd" type="password" placeholder="密碼 / Password" autocomplete="current-password" />
      <button class="btn" id="btnLogin">進入 / Enter</button>
      <button class="btn gray" id="btnClear">清除 / Clear</button>
      <div id="err" class="error">密碼錯誤，請再試一次。/ Incorrect password.</div>
    </div>
  </div>

  <!-- (B) 內容 -->
  <div id="app" class="hidden">
    <hr>

    <h3 class="section-title-red">交易策略</h3>
    <div class="strategy-grid">
      <!-- 1) 順勢型 -->
      <div class="strategy-col">
        <p class="subcat">順勢型</p>

        <a class="card" href="0807.html">
          <p class="card-title red">台指近-0807版本</p>
          <div class="lines">
            <!-- 週：上行＝當週，下行＝自該週起算累計 -->
            <p class="line">
              <span class="label">近1週報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="wk1-cur-range-0807" class="sub-range">—</span>
                  <span id="wk1-cur-0807" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="wk1-cum-range-0807" class="sub-range">—</span>
                  <span id="wk1-cum-0807" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近2週報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="wk2-cur-range-0807" class="sub-range">—</span>
                  <span id="wk2-cur-0807" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="wk2-cum-range-0807" class="sub-range">—</span>
                  <span id="wk2-cum-0807" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近3週報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="wk3-cur-range-0807" class="sub-range">—</span>
                  <span id="wk3-cur-0807" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="wk3-cum-range-0807" class="sub-range">—</span>
                  <span id="wk3-cum-0807" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近4週報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="wk4-cur-range-0807" class="sub-range">—</span>
                  <span id="wk4-cur-0807" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="wk4-cum-range-0807" class="sub-range">—</span>
                  <span id="wk4-cum-0807" class="sub-val neu">—</span>
                </span>
              </span>
            </p>

            <!-- 月：沿用原本邏輯，當月/累計視為區間 + 同區間 -->
            <p class="line">
              <span class="label">近1月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m1-cur-range-0807" class="sub-range">—</span>
                  <span id="m1-cur-0807" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m1-cum-range-0807" class="sub-range">—</span>
                  <span id="m1-cum-0807" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近2月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m2-cur-range-0807" class="sub-range">—</span>
                  <span id="m2-cur-0807" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m2-cum-range-0807" class="sub-range">—</span>
                  <span id="m2-cum-0807" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近3月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m3-cur-range-0807" class="sub-range">—</span>
                  <span id="m3-cur-0807" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m3-cum-range-0807" class="sub-range">—</span>
                  <span id="m3-cum-0807" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近4月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m4-cur-range-0807" class="sub-range">—</span>
                  <span id="m4-cur-0807" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m4-cum-range-0807" class="sub-range">—</span>
                  <span id="m4-cum-0807" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近5月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m5-cur-range-0807" class="sub-range">—</span>
                  <span id="m5-cur-0807" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m5-cum-range-0807" class="sub-range">—</span>
                  <span id="m5-cum-0807" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近6月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m6-cur-range-0807" class="sub-range">—</span>
                  <span id="m6-cur-0807" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m6-cum-range-0807" class="sub-range">—</span>
                  <span id="m6-cum-0807" class="sub-val neu">—</span>
                </span>
              </span>
            </p>

            <!-- 年 -->
            <p class="line">
              <span class="label">近1年報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="y1-cur-range-0807" class="sub-range">—</span>
                  <span id="y1-cur-0807" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="y1-cum-range-0807" class="sub-range">—</span>
                  <span id="y1-cum-0807" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近2年報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="y2-cur-range-0807" class="sub-range">—</span>
                  <span id="y2-cur-0807" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="y2-cum-range-0807" class="sub-range">—</span>
                  <span id="y2-cum-0807" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近3年報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="y3-cur-range-0807" class="sub-range">—</span>
                  <span id="y3-cur-0807" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="y3-cum-range-0807" class="sub-range">—</span>
                  <span id="y3-cum-0807" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近4年報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="y4-cur-range-0807" class="sub-range">—</span>
                  <span id="y4-cur-0807" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="y4-cum-range-0807" class="sub-range">—</span>
                  <span id="y4-cum-0807" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近5年報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="y5-cur-range-0807" class="sub-range">—</span>
                  <span id="y5-cur-0807" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="y5-cum-range-0807" class="sub-range">—</span>
                  <span id="y5-cum-0807" class="sub-val neu">—</span>
                </span>
              </span>
            </p>

            <p class="period">期間：<span id="period-0807">—</span></p>
          </div>
        </a>

        <a class="card" href="1001.html">
          <p class="card-title red">台指近-1001版本</p>
          <div class="lines">
            <!-- 1001 同樣結構，id 改為 1001 -->
            <p class="line">
              <span class="label">近1週報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="wk1-cur-range-1001" class="sub-range">—</span>
                  <span id="wk1-cur-1001" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="wk1-cum-range-1001" class="sub-range">—</span>
                  <span id="wk1-cum-1001" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近2週報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="wk2-cur-range-1001" class="sub-range">—</span>
                  <span id="wk2-cur-1001" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="wk2-cum-range-1001" class="sub-range">—</span>
                  <span id="wk2-cum-1001" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近3週報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="wk3-cur-range-1001" class="sub-range">—</span>
                  <span id="wk3-cur-1001" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="wk3-cum-range-1001" class="sub-range">—</span>
                  <span id="wk3-cum-1001" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近4週報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="wk4-cur-range-1001" class="sub-range">—</span>
                  <span id="wk4-cur-1001" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="wk4-cum-range-1001" class="sub-range">—</span>
                  <span id="wk4-cum-1001" class="sub-val neu">—</span>
                </span>
              </span>
            </p>

            <p class="line">
              <span class="label">近1月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m1-cur-range-1001" class="sub-range">—</span>
                  <span id="m1-cur-1001" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m1-cum-range-1001" class="sub-range">—</span>
                  <span id="m1-cum-1001" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近2月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m2-cur-range-1001" class="sub-range">—</span>
                  <span id="m2-cur-1001" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m2-cum-range-1001" class="sub-range">—</span>
                  <span id="m2-cum-1001" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近3月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m3-cur-range-1001" class="sub-range">—</span>
                  <span id="m3-cur-1001" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m3-cum-range-1001" class="sub-range">—</span>
                  <span id="m3-cum-1001" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近4月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m4-cur-range-1001" class="sub-range">—</span>
                  <span id="m4-cur-1001" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m4-cum-range-1001" class="sub-range">—</span>
                  <span id="m4-cum-1001" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近5月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m5-cur-range-1001" class="sub-range">—</span>
                  <span id="m5-cur-1001" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m5-cum-range-1001" class="sub-range">—</span>
                  <span id="m5-cum-1001" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近6月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m6-cur-range-1001" class="sub-range">—</span>
                  <span id="m6-cur-1001" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m6-cum-range-1001" class="sub-range">—</span>
                  <span id="m6-cum-1001" class="sub-val neu">—</span>
                </span>
              </span>
            </p>

            <p class="line">
              <span class="label">近1年報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="y1-cur-range-1001" class="sub-range">—</span>
                  <span id="y1-cur-1001" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="y1-cum-range-1001" class="sub-range">—</span>
                  <span id="y1-cum-1001" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近2年報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="y2-cur-range-1001" class="sub-range">—</span>
                  <span id="y2-cur-1001" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="y2-cum-range-1001" class="sub-range">—</span>
                  <span id="y2-cum-1001" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近3年報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="y3-cur-range-1001" class="sub-range">—</span>
                  <span id="y3-cur-1001" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="y3-cum-range-1001" class="sub-range">—</span>
                  <span id="y3-cum-1001" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近4年報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="y4-cur-range-1001" class="sub-range">—</span>
                  <span id="y4-cur-1001" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="y4-cum-range-1001" class="sub-range">—</span>
                  <span id="y4-cum-1001" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近5年報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="y5-cur-range-1001" class="sub-range">—</span>
                  <span id="y5-cur-1001" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="y5-cum-range-1001" class="sub-range">—</span>
                  <span id="y5-cum-1001" class="sub-val neu">—</span>
                </span>
              </span>
            </p>

            <p class="period">期間：<span id="period-1001">—</span></p>
          </div>
        </a>
      </div>

      <!-- 2) 逆勢型 -->
      <div class="strategy-col">
        <p class="subcat">逆勢型</p>
        <a class="card" href="etf-00909.html">
          <p class="card-title gray">台股-00909版本(研發中)</p>
          <div class="lines">
            <!-- 結構和上面相同，id 改成 00909 -->
            <p class="line">
              <span class="label">近1週報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="wk1-cur-range-00909" class="sub-range">—</span>
                  <span id="wk1-cur-00909" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="wk1-cum-range-00909" class="sub-range">—</span>
                  <span id="wk1-cum-00909" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近2週報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="wk2-cur-range-00909" class="sub-range">—</span>
                  <span id="wk2-cur-00909" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="wk2-cum-range-00909" class="sub-range">—</span>
                  <span id="wk2-cum-00909" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近3週報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="wk3-cur-range-00909" class="sub-range">—</span>
                  <span id="wk3-cur-00909" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="wk3-cum-range-00909" class="sub-range">—</span>
                  <span id="wk3-cum-00909" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近4週報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="wk4-cur-range-00909" class="sub-range">—</span>
                  <span id="wk4-cur-00909" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="wk4-cum-range-00909" class="sub-range">—</span>
                  <span id="wk4-cum-00909" class="sub-val neu">—</span>
                </span>
              </span>
            </p>

            <p class="line">
              <span class="label">近1月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m1-cur-range-00909" class="sub-range">—</span>
                  <span id="m1-cur-00909" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m1-cum-range-00909" class="sub-range">—</span>
                  <span id="m1-cum-00909" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近2月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m2-cur-range-00909" class="sub-range">—</span>
                  <span id="m2-cur-00909" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m2-cum-range-00909" class="sub-range">—</span>
                  <span id="m2-cum-00909" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近3月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m3-cur-range-00909" class="sub-range">—</span>
                  <span id="m3-cur-00909" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m3-cum-range-00909" class="sub-range">—</span>
                  <span id="m3-cum-00909" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近4月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m4-cur-range-00909" class="sub-range">—</span>
                  <span id="m4-cur-00909" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m4-cum-range-00909" class="sub-range">—</span>
                  <span id="m4-cum-00909" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近5月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m5-cur-range-00909" class="sub-range">—</span>
                  <span id="m5-cur-00909" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m5-cum-range-00909" class="sub-range">—</span>
                  <span id="m5-cum-00909" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近6月報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="m6-cur-range-00909" class="sub-range">—</span>
                  <span id="m6-cur-00909" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="m6-cum-range-00909" class="sub-range">—</span>
                  <span id="m6-cum-00909" class="sub-val neu">—</span>
                </span>
              </span>
            </p>

            <p class="line">
              <span class="label">近1年報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="y1-cur-range-00909" class="sub-range">—</span>
                  <span id="y1-cur-00909" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="y1-cum-range-00909" class="sub-range">—</span>
                  <span id="y1-cum-00909" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近2年報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="y2-cur-range-00909" class="sub-range">—</span>
                  <span id="y2-cur-00909" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="y2-cum-range-00909" class="sub-range">—</span>
                  <span id="y2-cum-00909" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近3年報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="y3-cur-range-00909" class="sub-range">—</span>
                  <span id="y3-cur-00909" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="y3-cum-range-00909" class="sub-range">—</span>
                  <span id="y3-cum-00909" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近4年報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="y4-cur-range-00909" class="sub-range">—</span>
                  <span id="y4-cur-00909" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="y4-cum-range-00909" class="sub-range">—</span>
                  <span id="y4-cum-00909" class="sub-val neu">—</span>
                </span>
              </span>
            </p>
            <p class="line">
              <span class="label">近5年報酬率</span>
              <span class="valblock">
                <span class="sub-row cur">
                  <span id="y5-cur-range-00909" class="sub-range">—</span>
                  <span id="y5-cur-00909" class="sub-val neu">—</span>
                </span>
                <span class="sub-row cum">
                  <span id="y5-cum-range-00909" class="sub-range">—</span>
                  <span id="y5-cum-00909" class="sub-val neu">—</span>
                </span>
              </span>
            </p>

            <p class="period">期間：<span id="period-00909">—</span></p>
          </div>
        </a>
      </div>

      <!-- 3) 盤整型 -->
      <div class="strategy-col">
        <p class="subcat">盤整型</p>
        <!-- 預留 -->
      </div>
    </div>

    <hr>

    <h3 class="section-title-blue">分析</h3>
    <div style="height:8px;"></div>

    <div class="nav">
      <a class="card" href="single-trades.html">
        <p class="card-title blue big">期貨策略研究</p>
        <p class="card-desc"></p>
      </a>

      <a class="card" href="multi-pro.html">
        <p class="card-title blue big">期貨最佳化參數研究</p>
        <p class="card-desc"></p>
      </a>
    </div>

    <div style="height:12px;"></div>

    <div class="nav">
      <a class="card" href="stock-multi-cloud.html">
        <p class="card-title blue big">股票策略研究</p>
        <p class="card-desc"></p>
      </a>
    </div>

    <hr>

    <h3 class="section-title-black">資料</h3>
    <div class="nav">
      <a class="card" href="upload.html">
        <p class="card-title black big">上傳檔案</p>
        <p class="card-desc"></p>
      </a>
    </div>
  </div>

  <!-- ===== JS：門檻 + 讀檔 + 報酬填值 ===== -->
  <script>
  (function(){
    'use strict';

    const SUPABASE_URL      = "https://byhbmmnacezzgkwfkozs.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ5aGJtbW5hY2V6emdrd2Zrb3pzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg1OTE0NzksImV4cCI6MjA3NDE2NzQ3OX0.VCSye3-fKrQphejdJSWAM6iRzv_7gkl8MLe7NeVszR0";
    const BUCKET = "reports";

    const PASS_HASH = "0f2b9305e317408510dc9878381e953630ed9fa3d2aadf95f1b8eb47941b18b9";
    const KEY_OK='__auth_ok__', FAIL_KEY='__auth_fail__', LOCK_UNTIL_KEY='__auth_lock_until__';
    const IDLE_MS = 30*60*1000;

    const $ = s => document.querySelector(s);
    const shield = $('#shield'), gate = $('#gate'), app = $('#app');
    const pwd = $('#pwd'), btnLogin = $('#btnLogin'), btnClear = $('#btnClear'), err = $('#err');

    if (window.top !== window.self){ try{ window.top.location = window.self.location.href; }catch(_){} }

    window.addEventListener('contextmenu', e=>{ e.preventDefault(); }, {capture:true});
    window.addEventListener('copy', e=>e.preventDefault(), {capture:true});
    window.addEventListener('cut',  e=>e.preventDefault(), {capture:true});
    window.addEventListener('selectstart', e=>e.preventDefault(), {capture:true});
    window.addEventListener('keydown', (e)=>{
      const K=(e.key||'').toUpperCase();
      if(e.key==='F12'){ e.preventDefault(); shield.style.display='flex'; }
      if(e.ctrlKey && ['U','S','P'].includes(K)){ e.preventDefault(); shield.style.display='flex'; }
      if(e.ctrlKey && e.shiftKey && ['I','J','C','K'].includes(K)){ e.preventDefault(); shield.style.display='flex'; }
    }, {capture:true});

    function isLocked(){ const until=+(sessionStorage.getItem(LOCK_UNTIL_KEY)||0); return Date.now()<until; }
    function remainingLockSec(){ const until=+(sessionStorage.getItem(LOCK_UNTIL_KEY)||0); return Math.max(0, Math.ceil((until-Date.now())/1000)); }
    function setLock(seconds){ sessionStorage.setItem(LOCK_UNTIL_KEY, String(Date.now()+seconds*1000)); }
    function addFailAndMaybeLock(){
      const n=(+(sessionStorage.getItem(FAIL_KEY)||0))+1;
      sessionStorage.setItem(FAIL_KEY,String(n));
      if(n>=5){
        const m=Math.min(60, Math.pow(2, n-5));
        setLock(m*60);
      }
    }
    function resetFails(){ sessionStorage.removeItem(FAIL_KEY); sessionStorage.removeItem(LOCK_UNTIL_KEY); }

    let idleTimer=null;
    function startIdleLogout(){
      const kick=()=>{ sessionStorage.removeItem(KEY_OK); location.reload(); };
      const bump=()=>{ clearTimeout(idleTimer); idleTimer=setTimeout(kick, IDLE_MS); };
      ['click','keydown','mousemove','touchstart','scroll'].forEach(ev=>document.addEventListener(ev,bump,{passive:true}));
      bump();
    }

    function enableDevtoolsWatchAfterLogin(){
      let suspect=0;
      function trig(){ if(++suspect>=3) shield.style.display='flex'; }
      setInterval(()=>{
        if (Math.abs(window.outerWidth-window.innerWidth)>250 ||
            Math.abs(window.outerHeight-window.innerHeight)>250) trig();
        else suspect=0;
      }, 1000);
      (function loop(p){
        const n=performance.now();
        if(n-p>1200) trig(); else suspect=0;
        requestAnimationFrame(()=>loop(performance.now()));
      })(performance.now());
    }

    async function sha256Hex(t){
      const buf=await crypto.subtle.digest('SHA-256', new TextEncoder().encode(t));
      return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
    }

    async function enter(){
      err.style.display='none';
      if(isLocked()){
        err.textContent=`嘗試次數過多，請 ${remainingLockSec()} 秒後再試。`;
        err.style.display='';
        return;
      }
      const v=(pwd.value||'').trim();
      if(!v){
        err.textContent='請輸入密碼 / Please enter password.';
        err.style.display='';
        return;
      }
      const t0=Date.now();
      if(await sha256Hex(v)===PASS_HASH){
        sessionStorage.setItem(KEY_OK,'1'); resetFails();
        gate.classList.add('hidden'); app.classList.remove('hidden');
        startIdleLogout(); enableDevtoolsWatchAfterLogin(); loadDepsAndRun();
      }else{
        const delay = 1000 + Math.random()*600 - (Date.now()-t0);
        if(delay>0) await new Promise(r=>setTimeout(r, delay));
        addFailAndMaybeLock();
        err.textContent='密碼錯誤，請再試一次。/ Incorrect password.';
        err.style.display='';
      }
    }

    btnLogin.addEventListener('click', enter);
    btnClear.addEventListener('click', ()=>{
      pwd.value='';
      err.style.display='none';
      resetFails();
      sessionStorage.removeItem(KEY_OK);
      pwd.focus();
    });
    pwd.addEventListener('keydown', e=>{ if(e.key==='Enter') enter(); });

    (function boot(){
      if(sessionStorage.getItem(KEY_OK)==='1'){
        gate.classList.add('hidden'); app.classList.remove('hidden');
        startIdleLogout(); enableDevtoolsWatchAfterLogin(); loadDepsAndRun();
      }
    })();

    function loadScript(src){
      return new Promise((res,rej)=>{
        const s=document.createElement('script');
        s.src=src;
        s.onload=res;
        s.onerror=()=>rej(new Error('load fail: '+src));
        document.body.appendChild(s);
      });
    }

    async function loadDepsAndRun(){
      await loadScript('https://unpkg.com/@supabase/supabase-js@2');
      await loadScript('shared.js?v=txfee45tax2');

      (async function(){
        const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
          global:{ fetch:(u,o={})=>fetch(u,{...o,cache:'no-store'}) }
        });

        const WANT = {
          "0807": /(0807)/i,
          "1001": /(1001)/i,
          "00909": /(00909|etf[-_]?00909)/i
        };
        const pubUrl = (path) => sb.storage.from(BUCKET).getPublicUrl(path).data.publicUrl;

        async function listDir(prefix){
          const p = (prefix && !prefix.endsWith('/')) ? prefix + '/' : (prefix || '');
          const { data } = await sb.storage.from(BUCKET).list(p, {
            limit:1000,
            sortBy:{ column:'name', order:'asc' }
          });
          return (data || []).map(it => ({ ...it, fullPath: p + it.name }));
        }

        async function listDeepN(prefix, depth, maxDepth, out){
          if(depth>maxDepth) return;
          const entries = await listDir(prefix);
          for(const it of entries){
            if(!it.id && !it.metadata){
              await listDeepN(it.fullPath, depth+1, maxDepth, out);
            }else{
              out.push(it);
            }
          }
        }

        async function readManifest(name){
          const tries=[name, `tw-${name}`];
          for(const n of tries){
            try{
              const { data } = await sb.storage.from(BUCKET).download(`manifests/${n}.json`);
              if(data) return JSON.parse(await data.text());
            }catch{}
          }
          return null;
        }

        async function latestFileByRegex(keyRegex){
          const all=[]; await listDeepN('', 0, 8, all);
          const files = all.filter(it=>{
            const n=(it.name||''), p=(it.fullPath||'');
            return keyRegex.test(p) || keyRegex.test(n);
          });
          if(!files.length) return null;
          const scoreByPath = p => {
            const m = (p||'').match(/\b(20\d{6})\b/g);
            return m ? Math.max(...m.map(s=>+s)) : 0;
          };
          files.sort((a,b)=>{
            const sa=scoreByPath(a.fullPath), sb=scoreByPath(b.fullPath);
            if(sa!==sb) return sb-sa;
            const ta=Date.parse(a.updated_at||0)||0;
            const tb=Date.parse(b.updated_at||0)||0;
            if(ta!==tb) return tb-ta;
            return (b.metadata?.size||0)-(a.metadata?.size||0);
          });
          return files[0];
        }

        const CANON_RE=/^(\d{14})\.0{6}\s+(\d+\.\d{6})\s+(新買|平賣|新賣|平買|強制平倉)\s*$/;
        const EXTRACT_RE=/.*?(\d{14})(?:\.0{1,6})?\s+(\d+(?:\.\d{1,6})?)\s*(新買|平賣|新賣|平買|強制平倉)\s*$/;

        function mapAction(act){
          if(act==='強平') return '強制平倉';
          if(/^(買進|加碼|再加碼|加碼攤平)$/i.test(act)) return '新買';
          if(/^賣出$/i.test(act)) return '平賣';
          return act;
        }

        function normalizeText(raw){
          let s=raw.replace(/\ufeff/gi,'').replace(/\u200b|\u200c|\u200d/gi,'');
          s=s.replace(/[\x00-\x09\x0B-\x1F\x7F]/g,'')
             .replace(/\r\n?/g,'\n')
             .replace(/\u3000/g,' ');
          return s.split('\n').map(l=>l.replace(/\s+/g,' ').trim()).filter(Boolean).join('\n');
        }

        const CSV_LINE_RE=/^(\d{8}),(\d{5,6}),(\d+(?:\.\d+)?),([^,]+?),/;
        function padTime6(t){ t=String(t||'').trim(); return t.padStart(6,'0').slice(0,6); }

        function canonicalize(txt){
          const out=[]; let ok=0;
          const lines = txt.split('\n');
          for(const l of lines){
            let m=l.match(EXTRACT_RE);
            if(m){
              const ts=m[1], px=Number(m[2]);
              out.push(`${ts}.000000 ${px.toFixed(6)} ${m[3]}`);
              ok++; continue;
            }
            m = l.match(CSV_LINE_RE);
            if(m){
              const d8=m[1], t6=padTime6(m[2]), px=Number(m[3]), act0=m[4].trim();
              if(Number.isFinite(px)){
                out.push(`${d8}${t6}.000000 ${px.toFixed(6)} ${mapAction(act0)}`);
                ok++; continue;
              }
            }
          }
          return { canon: out.join('\n'), ok };
        }

        async function fetchSmart(url){
          const res=await fetch(url,{cache:'no-store'});
          if(!res.ok) throw new Error(`${res.status} ${res.statusText}`);
          const buf=await res.arrayBuffer();
          for(const enc of ['utf-8','big5','utf-16le','utf-16be']){
            try{
              const td=new TextDecoder(enc);
              const norm=normalizeText(td.decode(buf));
              const {canon,ok}=canonicalize(norm);
              if(ok>0) return {canon,ok};
            }catch{}
          }
          const td=new TextDecoder('utf-8');
          const norm=normalizeText(td.decode(buf));
          const {canon,ok}=canonicalize(norm);
          return {canon,ok};
        }

        function parseCanon(text){
          const rows=[]; if(!text) return rows;
          for(const line of text.split('\n')){
            const m=line.match(CANON_RE);
            if(m) rows.push({ts:m[1], line});
          }
          rows.sort((a,b)=>a.ts.localeCompare(b.ts));
          return rows;
        }

        function dailySeriesFromMerged(mergedTxt){
          const parsed=window.SHARED.parseTXT(mergedTxt);
          const report=window.SHARED.buildReport(parsed.rows);
          const m=new Map();
          for(const t of report.trades){
            const d=String(t.tsOut).slice(0,8);
            m.set(d,(m.get(d)||0)+t.gainSlip);
          }
          const days=[...m.keys()].sort();
          const vals=days.map(d=>m.get(d));
          return {days, vals};
        }

        const d8=s=> new Date(`${s.slice(0,4)}-${s.slice(4,6)}-${s.slice(6,8)}T00:00:00`);
        const fmtD8=s=> `${s.slice(0,4)}/${s.slice(4,6)}/${s.slice(6,8)}`;

        function buildPrefix(vals){
          const p=[0];
          for(const v of vals){ p.push(p[p.length-1]+v); }
          return p;
        }

        // --- 週：每列一個「週段」 ＋ 從該週起算到最後一日的累積 ---
        function weekSegments(days, vals, maxWeeks){
          const res=[];
          if(!days.length) return res;
          const pref=buildPrefix(vals);
          const lastIdx=days.length-1;
          const lastDate=d8(days[lastIdx]);

          const dow=lastDate.getDay();
          const offsetToMonday=(dow+6)%7;
          const monday0=new Date(
            lastDate.getFullYear(),
            lastDate.getMonth(),
            lastDate.getDate()-offsetToMonday
          );

          for(let k=0;k<maxWeeks;k++){
            const startCand=new Date(monday0.getTime()-k*7*86400000);
            const endCand=new Date(startCand.getTime()+6*86400000);

            let i=0;
            while(i<=lastIdx && d8(days[i])<startCand) i++;
            if(i>lastIdx){ res.push(null); continue; }

            let j=i;
            while(j<=lastIdx && d8(days[j])<=endCand) j++;
            j--;
            if(j<i){ res.push(null); continue; }

            const sumCur=pref[j+1]-pref[i];
            const sumCum=pref[lastIdx+1]-pref[i];

            const startStr=fmtD8(days[i]);
            const endCurStr=fmtD8(days[j]);
            const endLastStr=fmtD8(days[lastIdx]);

            res.push({
              curRange:`${startStr}~${endCurStr}`,
              curRet:sumCur/1_000_000,
              cumRange:`${startStr}~${endLastStr}`,
              cumRet:sumCum/1_000_000
            });
          }
          return res;
        }

        // 月、年沿用「最近 N 天窗」邏輯
        function simpleReturnWithRange(days, vals, winDays){
          if(!days.length) return {ret:null, range:'---'};
          const end=days[days.length-1];
          const thr=new Date(d8(end).getTime()-(winDays-1)*86400000);
          let i=0; while(i<days.length && d8(days[i])<thr) i++;
          if(i>=days.length) return {ret:null, range:'---'};
          const startDay=days[i];
          const pref=buildPrefix(vals);
          const sum=pref[vals.length]-pref[i];
          return { ret:sum/1_000_000, range:`${fmtD8(startDay)}~${fmtD8(end)}` };
        }

        function simpleReturnYearWindowWithRange(days, vals, winDays){
          if(!days.length) return {ret:null, range:'---'};
          const first=days[0], last=days[days.length-1];
          const cover=Math.max(1, Math.round((d8(last)-d8(first))/86400000)+1);
          if(cover < winDays-60) return {ret:null, range:'---'};
          const end=last;
          const thr=new Date(d8(end).getTime()-(winDays-1)*86400000);
          let i=0; while(i<days.length && d8(days[i])<thr) i++; if(i>=days.length) i=0;
          const startDay=days[i];
          const pref=buildPrefix(vals);
          const sum=pref[vals.length]-pref[i];
          return { ret:sum/1_000_000, range:`${fmtD8(startDay)}~${fmtD8(end)}` };
        }

        function setVal(id,v){
          const el=document.getElementById(id);
          if(!el) return;
          el.classList.remove('pos','neg','neu');
          if(v==null){
            el.textContent='—';
            el.classList.add('neu');
            return;
          }
          el.textContent=(v*100).toFixed(2)+'%';
          el.classList.add(v>0?'pos':(v<0?'neg':'neu'));
        }
        function setRange(id,prefix,range){
          const el=document.getElementById(id);
          if(!el) return;
          if(!range || range==='---'){
            el.textContent = prefix ? `${prefix}—` : '—';
          }else{
            el.textContent = prefix ? `${prefix}${range}` : range;
          }
        }

        const WEEK_KEYS = ['wk1','wk2','wk3','wk4'];
        const MONTH_KEYS = ['m1','m2','m3','m4','m5','m6'];
        const YEAR_KEYS  = ['y1','y2','y3','y4','y5'];
        const ALL_KEYS   = WEEK_KEYS.concat(MONTH_KEYS).concat(YEAR_KEYS);

        function resetAll(key){
          ALL_KEYS.forEach(k=>{
            ['cur-range','cur','cum-range','cum'].forEach(tag=>{
              const id = `${k}-${tag}-${key}`;
              const el = document.getElementById(id);
              if(!el) return;
              if(tag.includes('range')){
                el.textContent='—';
              }else{
                el.textContent='—';
                el.classList.remove('pos','neg'); el.classList.add('neu');
              }
            });
          });
        }

        async function resolveLatest(key){
          const mf = await readManifest(key);
          if(mf){
            if(mf.latest_path) return { fullPath: mf.latest_path };
            if(mf.prefix){
              const all=[]; await listDeepN(mf.prefix, 0, 5, all);
              const files = all.filter(it=>it.metadata);
              if(files.length){
                files.sort((a,b)=> (Date.parse(b.updated_at||0)||0) - (Date.parse(a.updated_at||0)||0));
                return files[0];
              }
            }
          }
          return await latestFileByRegex(WANT[key]);
        }

        async function fillCard(key){
          const setPeriod=text=>{
            const el=document.getElementById(`period-${key}`);
            if(el) el.textContent=text;
          };

          try{
            const latest=await resolveLatest(key);
            if(!latest){
              resetAll(key);
              setPeriod('—');
              return;
            }

            const latestText=(await fetchSmart(pubUrl(latest.fullPath))).canon;

            const rows=parseCanon(latestText);
            const start8=rows.length?rows[0].ts.slice(0,8):'';
            const end8  =rows.length?rows[rows.length-1].ts.slice(0,8):'';

            const {days, vals}=dailySeriesFromMerged(latestText);

            // 週：週段 + 自該週起算至今
            const segW = weekSegments(days, vals, 4);
            WEEK_KEYS.forEach((k,idx)=>{
              const seg=segW[idx];
              if(!seg){
                setRange(`${k}-cur-range-${key}`,'當週 ',null);
                setVal(`${k}-cur-${key}`,null);
                setRange(`${k}-cum-range-${key}`,'累計 ',null);
                setVal(`${k}-cum-${key}`,null);
              }else{
                setRange(`${k}-cur-range-${key}`,'當週 ',seg.curRange);
                setVal(`${k}-cur-${key}`,seg.curRet);
                setRange(`${k}-cum-range-${key}`,'累計 ',seg.cumRange);
                setVal(`${k}-cum-${key}`,seg.cumRet);
              }
            });

            // 月：最近 30/60/... 天窗，當月/累計視為同一區間
            const M1=simpleReturnWithRange(days, vals, 30);
            const M2=simpleReturnWithRange(days, vals, 60);
            const M3=simpleReturnWithRange(days, vals, 90);
            const M4=simpleReturnWithRange(days, vals, 120);
            const M5=simpleReturnWithRange(days, vals, 150);
            const M6=simpleReturnWithRange(days, vals, 180);
            const M = {m1:M1,m2:M2,m3:M3,m4:M4,m5:M5,m6:M6};
            MONTH_KEYS.forEach(k=>{
              const r=M[k];
              setRange(`${k}-cur-range-${key}`,'當月 ',r.range);
              setVal(`${k}-cur-${key}`,r.ret);
              setRange(`${k}-cum-range-${key}`,'累計 ',r.range);
              setVal(`${k}-cum-${key}`,r.ret);
            });

            // 年：最近 1/2/3/4/5 年窗
            const Y1=simpleReturnYearWindowWithRange(days, vals, 365);
            const Y2=simpleReturnYearWindowWithRange(days, vals, 730);
            const Y3=simpleReturnYearWindowWithRange(days, vals, 1095);
            const Y4=simpleReturnYearWindowWithRange(days, vals, 1460);
            const Y5=simpleReturnYearWindowWithRange(days, vals, 1825);
            const Y = {y1:Y1,y2:Y2,y3:Y3,y4:Y4,y5:Y5};
            YEAR_KEYS.forEach(k=>{
              const r=Y[k];
              setRange(`${k}-cur-range-${key}`,'當年 ',r.range);
              setVal(`${k}-cur-${key}`,r.ret);
              setRange(`${k}-cum-range-${key}`,'累計 ',r.range);
              setVal(`${k}-cum-${key}`,r.ret);
            });

            setPeriod(`${start8||'—'} - ${end8||'—'}`);
          }catch(e){
            resetAll(key);
            const el=document.getElementById(`period-${key}`);
            if(el) el.textContent='—';
          }
        }

        await Promise.all([
          fillCard("0807"),
          fillCard("1001"),
          fillCard("00909")
        ]);
      })();
    }
  })();
  </script>
</body>
</html>
